import{_ as S,f as u,c as k,a as r,t as d,n as M,o as $}from"./index-Dhsrr7pS.js";const N={class:"uploader"},b=["disabled"],E={class:"progress-bar"},R={class:"progress-text"},h=1024*1024,z=10,f=2,I={__name:"Study",setup(T){const o=u(null),i=u(!1),l=u(0);function p(e){const t=[];let s=0;for(let n=0;n<e.size;n+=h){const c=Math.min(n+h,e.size);t.push({index:s,data:e.slice(n,c)}),s++}return t}function _(e,t){return new Promise((s,n)=>{setTimeout(()=>{Math.random()<.1?(console.log(`åˆ†ç‰‡ ${e.index+1}/${t} ä¸Šä¼ æˆåŠŸ`),s()):n(new Error(`åˆ†ç‰‡ ${e.index+1} ä¸Šä¼ å¤±è´¥`))},400+Math.random()*600)})}async function g(e,t){for(let s=1;s<=f;s++)try{await _(e,t);return}catch(n){if(console.warn(n.message,`ç¬¬ ${s} æ¬¡å°è¯•`),s===f)throw n}}async function v(e,t){const s=JSON.parse(localStorage.getItem(t)||"[]"),n=e.filter(a=>!s.includes(a.index));let c=s.length;async function w(){for(;n.length;){const a=n.shift();try{await g(a,e.length),c++,s.push(a.index),localStorage.setItem(t,JSON.stringify(s)),l.value=Math.round(c/e.length*100)}catch(x){console.error(x.message),n.push(a)}}}const C=Array.from({length:z},w);try{await Promise.all(C)}catch(a){console.error(a.message),i.value=!1,l.value=0,alert("ä¸Šä¼ å¤±è´¥ ğŸ’”")}}function m(e){o.value=e.target.files[0]}async function y(){if(!o.value){alert("è¯·é€‰æ‹©æ–‡ä»¶");return}i.value=!0,l.value=0;const e=`${o.value.name}_${o.value.size}_${o.value.lastModified}`,t=p(o.value);await v(t,e),setTimeout(()=>{alert("ä¸Šä¼ å®Œæˆ ğŸ‰"),i.value=!1,l.value=0},10)}return(e,t)=>($(),k("div",N,[t[0]||(t[0]=r("h2",null,"åˆ†ç‰‡ä¸Šä¼  + å¹¶å‘ + æ–­ç‚¹ç»­ä¼ ï¼ˆVueï¼‰",-1)),r("input",{type:"file",onChange:m},null,32),r("button",{disabled:i.value,onClick:y},d(i.value?"ä¸Šä¼ ä¸­...":"å¼€å§‹ä¸Šä¼ "),9,b),r("div",E,[r("div",{class:"progress-inner",style:M({width:l.value+"%"})},null,4)]),r("p",R,"è¿›åº¦ï¼š"+d(l.value)+"%",1)]))}},B=S(I,[["__scopeId","data-v-2cf7899b"]]);export{B as default};
